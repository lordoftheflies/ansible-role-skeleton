---
# roles/{{ role_name }}/tasks/main.yml

# Boilerplate tasks
{% raw %}

- name: "Include version-specific variables for OS."
  include_vars: "{{ specific_variables }}"
  with_first_found:
    - files:
        - "{{ fact_role_path }}/vars/{{ ansible_distribution|lower }}_{{ ansible_distribution_version }}.yml"
        - "{{ fact_role_path }}/vars/{{ ansible_distribution|lower }}_{{ ansible_distribution_major_version }}.yml"
        - "{{ fact_role_path }}/vars/{{ ansible_distribution|lower }}.yml"
        - "{{ fact_role_path }}/vars/{{ ansible_os_family|lower }}.yml"
      loop_control: loop_var=specific_variables
      skip: true

- name: "Include OS specific tasks"
  include_tasks: "{{ specific_tasks }}"
  with_first_found:
    - files:
        - "{{ fact_role_path }}/tasks/{{ ansible_distribution|lower }}_{{ ansible_distribution_version }}.yml"
        - "{{ fact_role_path }}/tasks/{{ ansible_distribution|lower }}_{{ ansible_distribution_major_version }}.yml"
        - "{{ fact_role_path }}/tasks/{{ ansible_distribution|lower }}.yml"
        - "{{ fact_role_path }}/tasks/{{ ansible_os_family|lower }}.yml"
      loop_control: loop_var=specific_tasks
      skip: true

- name: "Load distribution (centos, ubuntu) default variables"
  include_vars: "{{ item }}"
  with_first_found:
    - files:
        - "{{ fact_role_path }}/defaults/{{ ansible_distribution | lower }}.yml"
      skip: true
{% endraw %}

# Role tasks